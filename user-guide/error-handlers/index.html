<!DOCTYPE html>
<html lang="en-US">
<head>
  <script src="https://docs.nosqlbench.io/theme.min.js" integrity="sha384-IpIaa84kOKgkF5EJ0fD/kBe2wtIIsIB60ANGmuJxeA0dz5bSRfwBwp2/QybtQpU2"></script>
  <link rel="stylesheet" href="https://docs.nosqlbench.io/abridge-switcher.css?h=4238d999f44a7bb130d5" />
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <link rel="preload" as="style" class="preStyle" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" crossorigin="anonymous" />
  <script defer src="https://docs.nosqlbench.io/search_index.en.js?h=ae47d253e455a3aaacb2" integrity="sha384-cP47owL9Iuak1e1AA21cJA4BgagQtaPwAXBQG7QgJeE2JKGgkCBROHbCj/Xym6KC"></script>
  <script defer src="https://docs.nosqlbench.io/abridge-bundle-nofacade.min.js?h=9bcf621a2fcab7336017" integrity="sha384-u8AROOUG6n2Xjk2+7pvkkfeSIqinjI1tmqeBpZRlZtc5KFO/8DyFfEir6fAE2wcq"></script>
  <meta name="base" content="https://docs.nosqlbench.io" />
<meta name="robots" content="index, follow" />
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <title>Error Handlers | NoSQLBench Project</title>
  <meta name="copyright" content="NoSQLBench Project" />
  <meta name="description" content="NoSQLBench is an Open Source, Multi-Protocol, Pluggable, Scriptable, NoSQL (and more) Testing System." />
  <link rel="canonical" href="https://docs.nosqlbench.io/user-guide/error-handlers/" />
  <meta name="keywords" content="Abridge, Abridge.css, Zola, Theme, Zola Theme, getzola, Semantic Html, Fast, lightweight" />
  <meta property="og:url" content="https://docs.nosqlbench.io/user-guide/error-handlers/" />
  <meta name="twitter:url" content="https://docs.nosqlbench.io/user-guide/error-handlers/" />
  <meta property="og:description" content="NoSQLBench is an Open Source, Multi-Protocol, Pluggable, Scriptable, NoSQL (and more) Testing System." />
  <meta name="twitter:description" content="NoSQLBench is an Open Source, Multi-Protocol, Pluggable, Scriptable, NoSQL (and more) Testing System." />
  <meta property="og:title" content="Error Handlers | NoSQLBench Project" />
  <meta name="twitter:title" content="Error Handlers | NoSQLBench Project" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="https://docs.nosqlbench.io/nb5banner.png" />
  <meta property="og:image" content="https://docs.nosqlbench.io/nb5banner.png" />
  <meta property="og:site_name" content="NoSQLBench Project" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="website" />
  <meta property="og:updated_time" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="theme-color" content="#333333" />
  <meta name="msapplication-TileColor" content="#333333" />
  <link rel="manifest" href="https://docs.nosqlbench.io/site.webmanifest" />
  <link rel="mask-icon" href="https://docs.nosqlbench.io/safari-pinned-tab.svg" color="#ff9900" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://docs.nosqlbench.io/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://docs.nosqlbench.io/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://docs.nosqlbench.io/favicon-16x16.png" />
  <noscript><link rel="stylesheet" href="https://docs.nosqlbench.io/nojs.css" /></noscript>
</head>
<body>
  <header>
    <nav>
      <div><h1><a href="https://docs.nosqlbench.io/"><img src="https://docs.nosqlbench.io/nb5logo.png" alt="NoSQLBench5" width="32" height="32" />NoSQLBench v5</a></h1></div><div>
        <ul><li> <h2><a href="https://docs.nosqlbench.io/getting-started/">Getting Started</a></h2> </li><li> <h2><a href="https://docs.nosqlbench.io/release-notes/">Release Notes</a></h2> </li><li class="js"><i type="reset" id="mode" class="svgs adjust"></i></li></ul>
      </div>
      <div>
        <form autocomplete=off class="js" name="goSearch" id="searchbox">
          <div class="searchd">
            <input id="searchinput" type="text" placeholder="Search" title="Search" />
            <button type="submit" title="Search"><i class="svgs search"></i></button>
          </div>
          <div><div id="suggestions"></div></div>
        </form>
      </div>

      <a href="http://github.com/nosqlbench/nosqlbench-build-docs" title="This doc site's project repo">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 22 18"
             fill="none"
             stroke="currentColor" stroke-width="1" stroke-linecap="round"
             stroke-linejoin="round">
          <path
              d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
        </svg>
      </a>
      <a href="http://nosqlbench.io" title="NoSQLBench Project Site">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 22 18"
             fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round"
             stroke-linejoin="round">
          <path
              d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
        </svg>
      </a>
    </nav>
    <hr /><div style="position:sticky"><span><a href="&#x2F;">NB5 Docsâ–º </a></span><span title="Detailed documentation on all options and features of NoSQLBench"><a href="&#x2F;user-guide&#x2F;"><strong>User Guideâ–¼</strong> </a></span><span title="[current page]"><a href="&#x2F;user-guide&#x2F;error-handlers&#x2F;"><strong>Error Handlers ðŸ–º</strong></a></span>
</div></header>
  <main><!-- active_page: user-guide&#x2F;error-handlers.md -->
<!-- active_section: user-guide&#x2F;_index.md -->


<!-- lower_root: _index.md -->
<!-- >upper_root: _index.md -->

<div class="toc" aria-hidden="true" id="">
<!--  <h4>User Guide</h4>--><div class="toc-sticky"><div class="toc-item"title="Release Notes for each major and some minor releases"><a href="&#x2F;release-notes&#x2F;">â–ºRelease Notes</a></div><div class="toc-item"title="An introduction to what makes NoSQLBench Unique"><a href="&#x2F;introduction&#x2F;">â–ºIntroduction</a></div><div class="toc-item"title="Getting Started with NoSQLBench"><a href="&#x2F;getting-started&#x2F;">â–ºGetting Started</a></div><div class="toc-item"title="You can build workloads to simulate real-world data and access patterns."><a href="&#x2F;workloads-101&#x2F;">â–ºWorkloads 101</a></div><div class="toc-item"title="Detailed documentation on all options and features of NoSQLBench"><strong>â–¼User Guide</strong></div><!-- subsection_page_path: &#x2F;user-guide&#x2F;cli-options&#x2F; -->
    <div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;cli-options&#x2F;">CLI Options</a>
    </div><!-- subsection_page_path: &#x2F;user-guide&#x2F;ssl-options&#x2F; -->
    <div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;ssl-options&#x2F;">Standard SSL Options</a>
    </div><!-- subsection_page_path: &#x2F;user-guide&#x2F;cli-scripting&#x2F; -->
    <div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;cli-scripting&#x2F;">CLI Scripting</a>
    </div><!-- subsection_page_path: &#x2F;user-guide&#x2F;op-templates&#x2F; -->
    <div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;op-templates&#x2F;">Op Templates</a>
    </div><!-- subsection_page_path: &#x2F;user-guide&#x2F;core-op-fields&#x2F; -->
    <div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;core-op-fields&#x2F;">Core Op Fields</a>
    </div><!-- subsection_page_path: &#x2F;user-guide&#x2F;core-activity-params&#x2F; -->
    <div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;core-activity-params&#x2F;">Core Activity Params</a>
    </div><!-- subsection_page_path: &#x2F;user-guide&#x2F;error-handlers&#x2F; -->
    <div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;error-handlers&#x2F;"><strong>Error Handlers</strong></a>
    </div><!-- subsection_page_path: &#x2F;user-guide&#x2F;standard-metrics&#x2F; -->
    <div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;standard-metrics&#x2F;">Standard Metrics</a>
    </div><!-- subsection_page_path: &#x2F;user-guide&#x2F;metrics-options&#x2F; -->
    <div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;metrics-options&#x2F;">Metrics Options</a>
    </div><!-- subsection_page_path: &#x2F;user-guide&#x2F;grafana-metrics&#x2F; -->
    <div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;grafana-metrics&#x2F;">Built-In Grafana Dashboard</a>
    </div><!-- subsection_page_path: &#x2F;user-guide&#x2F;workloads-intro&#x2F; -->
    <div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;workloads-intro&#x2F;">Built-In Workloads</a>
    </div><!-- subsubsection_path: user-guide&#x2F;advanced-topics&#x2F;_index.md --><div class="toc-item-child">
      <a href="&#x2F;user-guide&#x2F;advanced-topics&#x2F;"title="Detailed documentation on all options and features of NoSQLBench">â€£ Advanced Topics</a>
    </div><div class="toc-item"title="The NB5 Developer Guide"><a href="&#x2F;dev-guide&#x2F;">â–ºDev Guide</a></div><div class="toc-item"title="Detailed reference on drivers, formats, bindings, from auto-imported docs"><a href="&#x2F;reference&#x2F;">â–ºReference Section</a></div></div>
</div>

<article>

  <p>NoSQLBench v5 has a standard error handler mechanism which is available to all drivers.</p>
<p>If no error handler is configured for an activity, then the default error handler is used:</p>
<pre class="z-code"><code><span class="z-text z-plain">errors=stop
</span></code></pre>
<p>This error handler is a modular and highly configurable error handler with a very basic set of 
defaults: If you don't configure it, then any error thrown by an activity will cause it to 
stop. This is indicated by the default <code>errors=stop</code>.</p>
<p>The default configuration is just a fail-fast default. It is the simplest possible error handler
configuration.</p>
<h2 id="handler-verbs">Handler Verbs</h2>
<p>The currently supported handler verbs, like <code>stop</code> above, are:</p>
<ul>
<li><strong>ignore</strong> If an error matches this verb in a handler chain, then it will be silently ignored.
It will not be retried. Although combining ignore with retry will cause it to be silently retried.</li>
<li><strong>counter</strong> Count each uniquely named error with a counter metric.</li>
<li><strong>histogram</strong> Track the session time of each uniquely named error with a histogram.</li>
<li><strong>meter</strong> Meter each uniquely named error with a meter metric.</li>
<li><strong>retry</strong> - Mark the error as retryable. If an activity has retries available, the operation will
be retried. By default, activities which allow ops to be retried will have <code>maxtries=10</code>.</li>
<li><strong>stop</strong> Allow the error to propagate through the stack to cause the activity to be stopped.</li>
<li><strong>timer</strong> Count, Meter, and Track session times of each uniquely named error with a timer metric,
which combines the three forms above.</li>
<li><strong>warn</strong> Log a warning to the log with the error details.</li>
<li><strong>code</strong> Assign a specific result code to any matching errors. You can configure this as
short-hand in a handler list as just a number: <code>errors=RuntimeException:33,warn</code></li>
</ul>
<p>You can use any of these verbs in any order in a handler list.</p>
<h2 id="chains-of-handler-lists">Chains of Handler Lists</h2>
<p>The structure of a handler is a list of list. In order to make this easier to discuss in terms of
configuration, the top level is called the <em>Handler Chain</em> and the individual handler lists at each
link in the chain are called <em>Handler Verbs</em>.</p>
<p>The first matching set of handler verbs is used. When an exception is thrown, the handler chain 
is walked until a matching handler is found. If none are found, then no handlers apply, which is 
the same as assigning <code>ignore</code>, which does nothing. If you want a default handler list to apply 
to otherwise-unmatched exceptions, be sure to add one at the end for anything matching <code>.*</code>.</p>
<p>The illustration below shows the handler chain structure for the handler configuration shown.</p>
<pre class="z-code"><code><span class="z-text z-plain"> errors=Invalid.*:ignore;Runtime.*:warn,histogram;counter,42

                     |-----------|-----------|-----------|
 handler chain ==&gt;   | 1         | 2         | 3         |
                     |===========|===========|===========|
 error patterns ==&gt;  | Invalid.* | Runtime.* | .*        |
                     |===========| Array.*   |===========|
 handler verbs ==&gt;   | ignore    |===========| counter   |
                     |-----------| warn      | 42        |
                                 | histogram |-----------|
                                 |-----------|
</span></code></pre>
<p>In this example, there are three handler configuration. When an error is thrown by an activity, the
handler chain is called. When a matching handler is found by matching any of the error patterns
against the exception name, that column (the handler list) is selected, and each handler in that
list is applied in order to the error.</p>
<p>Specifically, the Java class name of the exception type is matched against the error patterns going
left to right. The first one that matches selects the error handler list to use.</p>
<h2 id="error-handler-configuration">Error Handler Configuration</h2>
<p>The default setting of <code>errors=stop</code> uses a shorthand form for specifying error handlers. The
parameter name <code>errors</code> will become the universal activity parameter for configuring error handling
going forward.</p>
<p><code>errors=stop</code> is shorthand for <code>errors=.*:stop</code>. This is simply a single handler list which has the
default wildcard error matcher.</p>
<p>A handler definition is thus comprised of the error matching patterns and the error handling verbs
which should be applied when an error matches the patterns. If the error matching patterns are not
provided, then the default wildcard pattern and delimiter <code>.*:</code>is automatically prepended.</p>
<h3 id="error-pattern-formats">Error Pattern Formats</h3>
<p>An error pattern is simply a regular expression, although the characters are limited intentionally
to a subset: <code>[a-zA-Z0-9.-_*+]</code>. Multiple patterns may be used, like <code>Missing.*,RuntimeEx.*</code>.</p>
<p>More customizable ways to map an error to a particular handler list may be provided if/when needed.</p>
<h3 id="handler-verb-formats">Handler Verb Formats</h3>
<p>A specific handler list is defined as a set of handler verbs separated by commas. Alternately,
handler verbs may be blocks of JSON or other standard NoSQLBench encoding formats, as long as they
are protected by quotes:</p>
<pre class="z-code"><code><span class="z-text z-plain"># basic verb -only form
counter,warn

# using JSON
&quot;{\&quot;handler\&quot;=\&quot;counter\&quot;},{\&quot;handler\&quot;=\&quot;warn\&quot;}&quot;

# using simplified params form
&quot;handler=counter,handler=warn,handler=code code=42&quot;
</span></code></pre>
<p>This shows that handler verbs are really just short-hand for more canonical object definitions which
have their own properties. The handler property is the one that select which handler implementation
to use. Each handler implementation may have its own options. Those will be documented as they are
added.</p>
<h2 id="building-handler-chains">Building Handler Chains</h2>
<p>To construct a handler entry, simply concatenate the error pattern to the verbs using a colon.</p>
<p>To have multiple handler entries, concatenate them in the order of your choosing with semicolons.</p>
<h2 id="examples">Examples</h2>
<p>Count (in metrics) all occurrences of exceptions named Missing.* (anything matching the regex), but
count and warn about anything matching the exception nameRuntimeEx.*. Ignore everything else.</p>
<pre class="z-code"><code><span class="z-text z-plain">errors=&#39;Missing.*:counter;RuntimeEx.*:counter,warn;.*:ignore&#39;
</span></code></pre>
<p>Retry all operations which experience an IOException:</p>
<pre class="z-code"><code><span class="z-text z-plain">errors=&#39;IOException:retry&#39;
</span></code></pre>

<p><b><a href="#">Back to top</a></b></p>
</article>
<div class="toc" aria-hidden="true">
  <div class="toc-sticky">
    <h5>Error Handlers</h5>
    <div class="toc-item">
      <a class="subtext" href="https://docs.nosqlbench.io/user-guide/error-handlers/#handler-verbs">Handler Verbs</a>
    </div>
    <div class="toc-item">
      <a class="subtext" href="https://docs.nosqlbench.io/user-guide/error-handlers/#chains-of-handler-lists">Chains of Handler Lists</a>
    </div>
    <div class="toc-item">
      <a class="subtext" href="https://docs.nosqlbench.io/user-guide/error-handlers/#error-handler-configuration">Error Handler Configuration</a>
    </div>
    <div class="toc-item-child">
      <a class="subtext" href="https://docs.nosqlbench.io/user-guide/error-handlers/#error-pattern-formats"><small>- Error Pattern Formats</small></a>
    </div>
    <div class="toc-item-child">
      <a class="subtext" href="https://docs.nosqlbench.io/user-guide/error-handlers/#handler-verb-formats"><small>- Handler Verb Formats</small></a>
    </div>
    <div class="toc-item">
      <a class="subtext" href="https://docs.nosqlbench.io/user-guide/error-handlers/#building-handler-chains">Building Handler Chains</a>
    </div>
    <div class="toc-item">
      <a class="subtext" href="https://docs.nosqlbench.io/user-guide/error-handlers/#examples">Examples</a>
    </div>
  </div>
</div>
  </main>
  <footer>
    <hr />
    <div class="c">
      <nav>
        <ul></ul>
      </nav>
      <p class="s90">Copyright &copy; 2023-2023 NoSQLBench Project</p>
    </div>
  </footer>
</body>
</html>
